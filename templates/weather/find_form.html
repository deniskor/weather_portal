{% extends "base.html" %}

{% block content %}
    <form class='find-form' method='POST' action='.' data-url='{{ request.build_absolute_uri|safe }}'>
        {% csrf_token %}
        {{form.as_p|safe}}
        <button type='submit'>Find</button>
    </form>
{% endblock content %}

{% block javascript %}
      <script>
$(document).ready(function(){
    let $form= $('.find-form');
    $form.submit(function(event){
        event.preventDefault();
        var $formData = $(this).serialize();
        var $thisURL = $form.attr('data-url') || window.location.href; // or set your own url
        $.ajax({
            method: "POST",
            url: $thisURL,
            data: $formData,
            success: handleFormSuccess,
            error: handleFormError,
        })
    });

    function handleFormSuccess(data, textStatus, jqXHR){
        console.log(data);
        console.log(textStatus);
        console.log(jqXHR);
        $myForm.reset(); // reset form data
    }

    function handleFormError(jqXHR, textStatus, errorThrown){
        console.log(jqXHR);
        console.log(textStatus);
        console.log(errorThrown);
    }
})
</script>
{% endblock javascript %}